name: Deploy Hybrid Site
on:
  push:
    branches:  [ "main", "master" ]

permissions:
  contents: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v5
        with:
          python-version: 3.x

      - run: pip install mkdocs-material

      # 1. Build the MkDocs site (Generated files go to 'site/')
      - run: mkdocs build

      # 2. Create a temporary folder for the final website structure
      - name: Prepare Site Structure
        run: |
          mkdir _final_build
          
          # Move generated docs into a 'doc' subfolder
          mv site _final_build/doc
          
          # Copy your custom landing page to the root
          cp -r landing/* _final_build/

      # 3. Deploy the '_final_build' folder to gh-pages branch
      - uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: _final_build
          branch: gh-pages